<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rialo Stickman Cyberpunk</title>
<style>
body{margin:0;padding:0;background:#111;font-family:sans-serif;}
canvas{display:block;margin:0 auto;background:#111;}
.controls{position:absolute;top:10px;right:10px;z-index:2;}
button{margin-left:5px;padding:6px 12px;background:#333;color:#0ff;border:none;border-radius:5px;cursor:pointer;}
.message,.next-level,.retry{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);color:#0ff;padding:20px 40px;font-size:1.5em;border-radius:12px;display:none;text-align:center;}
.btn-next,.btn-retry{margin-top:15px;padding:8px 25px;background:#0ff;border:none;border-radius:8px;color:#111;cursor:pointer;}
</style>
</head>
<body>
<div class="controls">
<button id="playBtn">Play</button>
<button id="pauseBtn">Pause</button>
<button id="restartBtn">Restart</button>
</div>
<canvas id="game" width="900" height="480"></canvas>
<div class="next-level" id="nextLevel">
<span>Level Completed!</span><br>
<button class="btn-next" id="btnNext">Next Level</button>
</div>
<div class="retry" id="retry">
<span>You Lost!</span><br>
<button class="btn-retry" id="btnRetry">Retry</button>
</div>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

let player,enemy,bullets,keys,gameActive=false,gamePaused=false,level=1,frame=0;

// reset game
function reset(levelUp=false){
player={x:100,y:350,w:32,h:68,color:"#0ff",hp:100,maxHp:100,gunCD:0,bulletSpeed:7+level*1,doubleShot:level>=2};
enemy={x:700,y:350,w:32,h:68,color:"#f0f",hp:80+(level-1)*30,maxHp:80+(level-1)*30,speed:1.5+(level-1)*0.3,damage:20+(level-1)*5,gunCD:0,alive:true};
bullets=[];
keys={};
gameActive=true;
gamePaused=false;
document.getElementById('nextLevel').style.display="none";
document.getElementById('retry').style.display="none";
}

// draw cyberpunk background
function drawBackground(){
ctx.fillStyle="#111";
ctx.fillRect(0,0,canvas.width,canvas.height);
// moving horizontal neon lines
for(let i=0;i<20;i++){
ctx.strokeStyle=`rgba(0,255,255,${Math.sin(frame/20+i)*0.5+0.5})`;
ctx.beginPath();ctx.moveTo(0,i*24+frame%24);ctx.lineTo(canvas.width,i*24+frame%24);ctx.stroke();
// vertical lines
ctx.strokeStyle=`rgba(255,0,255,${Math.sin(frame/20+i)*0.5+0.5})`;
ctx.beginPath();ctx.moveTo(i*45+frame%45,0);ctx.lineTo(i*45+frame%45,canvas.height);ctx.stroke();
}
}

// draw stickman
function drawStickman(p,gun=false){
ctx.strokeStyle=p.color;ctx.lineWidth=4;
ctx.beginPath();
ctx.arc(p.x+16,p.y+14,14,0,Math.PI*2);
ctx.moveTo(p.x+16,p.y+28);ctx.lineTo(p.x+16,p.y+55);
ctx.moveTo(p.x+16,p.y+32);ctx.lineTo(p.x-4,p.y+43);
ctx.moveTo(p.x+16,p.y+32);ctx.lineTo(p.x+36,p.y+43);
ctx.moveTo(p.x+16,p.y+55);ctx.lineTo(p.x+4,p.y+80);
ctx.moveTo(p.x+16,p.y+55);ctx.lineTo(p.x+28,p.y+80);
ctx.stroke();
if(gun){ctx.fillStyle="#fff";ctx.fillRect(p.x+34,p.y+36,15,6);}
}

// draw bullets
function drawBullet(b){ctx.font='bold 16px monospace';ctx.fillStyle="#0ff";ctx.fillText('Rialo',b.x,b.y);}
// draw HP
function drawHP(p){ctx.fillStyle="#222";ctx.fillRect(p.x-6,p.y-22,54,11);ctx.fillStyle="#0f0";ctx.fillRect(p.x-6,p.y-22,54*p.hp/p.maxHp,11);ctx.strokeStyle="#fff";ctx.strokeRect(p.x-6,p.y-22,54,11);}

// update game logic
function update(){
if(!gameActive||gamePaused)return;

// player movement with side walls
if(keys['ArrowLeft'])player.x=Math.max(0,player.x-4);
if(keys['ArrowRight'])player.x=Math.min(canvas.width-32,player.x+4);
if(keys['ArrowUp']&&player.y>300)player.y-=9;
if(player.y<350)player.y+=5;

// enemy AI
if(enemy.alive){
if(player.x>enemy.x)enemy.x+=enemy.speed;
else enemy.x-=enemy.speed;
if(Math.abs(player.x-enemy.x)<200&&Math.random()<0.02&&enemy.gunCD<0){bullets.push({x:enemy.x,y:enemy.y+34,dx:(player.x<enemy.x?-5:5),dy:0,from:'enemy'});enemy.gunCD=45;}
enemy.gunCD--;
}

// player shooting
if(keys[' ']&&player.gunCD<0){
bullets.push({x:player.x+50,y:player.y+36,dx:player.bulletSpeed,dy:0,from:'player'});
if(player.doubleShot)bullets.push({x:player.x+50,y:player.y+36,dx:player.bulletSpeed,dy:-1,from:'player'});
player.gunCD=25;
}
if(keys['z']&&player.gunCD<0){
bullets.push({x:player.x-10,y:player.y+36,dx:-player.bulletSpeed,dy:0,from:'player'});
if(player.doubleShot)bullets.push({x:player.x-10,y:player.y+36,dx:-player.bulletSpeed,dy:-1,from:'player'});
player.gunCD=25;
}
player.gunCD--;

// move bullets and check hits
for(let i=bullets.length-1;i>=0;i--){
let b=bullets[i];
b.x+=b.dx;b.y+=b.dy;
if(b.from==='player'&&enemy.alive&&b.x>enemy.x&&b.x<enemy.x+36&&b.y>enemy.y&&b.y<enemy.y+80){enemy.hp-=18+level*2;bullets.splice(i,1);if(enemy.hp<=0){enemy.alive=false;win();}}
else if(b.from==='enemy'&&b.x>player.x&&b.x<player.x+32&&b.y>player.y&&b.y<player.y+80){player.hp-=enemy.damage;bullets.splice(i,1);if(player.hp<=0)lose();}
else if(b.x<0||b.x>canvas.width)bullets.splice(i,1);
}
}

// win/lose functions
function win(){gameActive=false;document.getElementById('nextLevel').style.display="block";}
function lose(){gameActive=false;document.getElementById('retry').style.display="block";}

// draw everything
function draw(){
drawBackground();
drawStickman(player,true);
drawHP(player);
if(enemy.alive){drawStickman(enemy);drawHP(enemy);}
bullets.forEach(drawBullet);
ctx.fillStyle="#0ff";ctx.font="bold 16px Arial";
ctx.fillText("← → move, ↑ jump, Space shoot right, Z shoot left",20,20);
ctx.fillText("Level: "+level,20,40);
}

// main loop
function gameLoop(){frame++;update();ctx.clearRect(0,0,canvas.width,canvas.height);draw();requestAnimationFrame(gameLoop);}

// controls
document.getElementById('playBtn').onclick=function(){gamePaused=false;};
document.getElementById('pauseBtn').onclick=function(){gamePaused=true;};
document.getElementById('restartBtn').onclick=function(){level=1;reset();};
document.getElementById('btnNext').onclick=function(){level+=1;reset(true);};
document.getElementById('btnRetry').onclick=function(){reset();};
window.addEventListener('keydown',e=>keys[e.key]=true);
window.addEventListener('keyup',e=>keys[e.key]=false);

reset();gameLoop();
</script>
</body>
</html>
